# IT 기획서: 할인·프로모션 실질가치 계산기 (Promo Value Calculator)

## 0. 문서 정보
- 버전: v1(MVP)
- 작성일: 2026-02-11
- 목적: 장바구니 기준으로 쿠폰/배송쿠폰 적용 결과를 정확히 계산하고 최적 조합을 추천하는 웹앱

---

## 1. 문제 정의

### 1.1 해결하려는 문제
- 사용자는 쿠폰/프로모션의 **표면 할인율**과 달리 실제 결제에서의 **실질 할인율/결제액**을 즉시 판단하기 어렵다.
- 특히 **최소 구매금액, 최대 할인 한도(cap), 배송비, 중복 규칙** 때문에 “어떤 쿠폰이 더 이득인지” 비교가 어렵다.

### 1.2 문제가 생긴 이유
- 할인 규칙이 복합적(조건/제약/중복/적용 순서)이며, 사용자에게 **계산 책임**이 전가됨.
- 플랫폼별 정책이 달라 체감이 혼란스러워지고, 반복 계산으로 시간/오류 비용이 발생.

### 1.3 목표
- 입력(장바구니 + 쿠폰 규칙) 기반으로 아래를 **재현 가능하게(정책 고정)** 계산한다.
    1) 최종 결제액
    2) 쿠폰별 실제 할인액(적용 내역)
    3) 실질 할인율(상품 기준 / 총액 기준)
    4) 가능한 조합 중 결제액 최소 Top3 추천

---

## 2. 서비스 설명

### 2.1 서비스 명
- Promo Value Calculator (가칭)

### 2.2 무엇을 해주는 서비스
- 장바구니/쿠폰을 입력하면:
    - 쿠폰 적용 가능 여부를 검증하고
    - 정책(적용 순서/반올림/최소금액 기준)에 따라
    - 최종 결제액 및 실질 할인율을 계산
    - 최적 쿠폰 조합을 추천

### 2.3 대상 사용자 정의
- 쿠폰이 많아 선택이 어려운 사용자(멤버십/플랫폼 다중 이용)
- 할인 비교에 시간을 쓰기 싫은 사용자(빠른 의사결정 필요)
- 계산 실수로 손해 보는 경험이 있는 사용자

---

## 3. 기대되는 결과
- 사용자는 “어떤 쿠폰이 진짜 이득인지”를 **숫자(결제액/할인율)**로 즉시 확인
- 쿠폰 선택 의사결정 시간 단축
- cap/minSpend/중복 규칙으로 인한 계산 오류 감소

---

## 4. 실제 사용법(기능)

### 4.0 정책/가정(정의 고정: MVP)
- 적용 순서(Policy A): **가격 쿠폰 → 배송 쿠폰**
- minSpend 기준: **상품 정가 합계(배송비 제외)**
- 반올림: **원 단위 버림(floor)**
- 중복 규칙: **가격 쿠폰 1장 + 배송 쿠폰 1장 동시 가능**(각 그룹 내 중복 불가)

### 4.1 핵심 기능(MVP)
1) 장바구니 입력(상품명/가격/수량/카테고리(선택), 배송비)
2) 쿠폰 입력 및 검증
    - %할인 쿠폰: rate, minSpend, cap
    - 정액 쿠폰: amount, minSpend, cap(선택)
    - 배송 쿠폰: shippingDiscount(또는 freeShipping), cap
3) 계산 결과 출력
    - 최종 결제액, 쿠폰별 할인액, 실질 할인율(2종)
4) 추천
    - 가능한 조합 중 결제액 최소 Top3

### 4.2 부가 기능(v2+ 후보)
- 확률형 프로모션 기대값(EV) 계산
- 포인트/캐시백 환산(가중치)
- 정책 선택(플랫폼별 적용 순서 지원)
- 장바구니 분할 구매 전략 추천

### 4.3 엣지 케이스(처리 규칙 포함)
- 할인액이 기준금액 초과: `discount = min(calculated, baseAmount, cap)`로 클램프
- 배송쿠폰이 배송비 초과: 배송비는 0원 미만 불가
- minSpend 미달: 적용 실패 + “부족 금액” 표시
- 입력 이상치(음수/0): 입력 단계 validation 에러
- 중복 규칙 위반: UI에서 선택 차단 + 추천 조합 생성 시 제외
- 제외 카테고리(확장): v1에서는 미지원(Out of Scope)

---

## 5. 유저 케이스(사용법)

### 5.1 시나리오별 정리
**S1. %쿠폰 vs 정액쿠폰 비교**
- 장바구니: 59,000원, 배송 3,000원
- C1: 20%(cap 8,000, min 50,000), C2: 7,000(min 40,000)
- 결과: C1 결제액 54,000 / C2 결제액 55,000 → C1 추천

**S2. 배송쿠폰 효과 확인**
- 장바구니: 19,900원, 배송 3,000원
- 무료배송 쿠폰(cap 3,000)
- 결과: 배송비 0원 처리

**S3. 최소금액 미달**
- 장바구니: 28,000원, 배송 3,000원
- 6,000원 쿠폰(min 30,000)
- 결과: 적용 실패, 부족 2,000원 안내

---

## 6. 정보 구조(IA) & 화면 기획(웹앱)

### 6.1 화면 구성
1) 입력 화면
- 장바구니 입력(아이템 리스트)
- 배송비 입력
- 쿠폰 추가(가격쿠폰/배송쿠폰)
- 정책/가정 표시(Policy A, minSpend 기준, 반올림)

2) 결과 화면
- 최종 결제액(핵심 KPI)
- 적용 내역(쿠폰별 할인액)
- 실질 할인율(상품 기준/총액 기준)
- 추천 조합 Top3 + “왜 이 조합인가”(간단 사유)

3) 비교 화면(선택)
- 쿠폰 A vs B 결제액/할인율 비교

### 6.2 UX 포인트
- 모든 결과에 “계산 기준(정책/반올림/minSpend)” 노출
- 실패 케이스는 ‘불가’가 아니라 사유+부족금액 안내
- 추천 결과는 Top3 제공(사용자 선택권 유지)

---

## 7. 기술 스택
- Frontend: Next.js(React), TypeScript
- Core Logic: 순수 함수 기반 계산 엔진(테스트 용이)
- Test: Vitest/Jest(계산 엔진 단위 테스트)
- Deploy: Vercel
- (선택) 상태관리: Zustand / 폼: React Hook Form

---

## 8. 범위(Scope) / 비범위(Out of Scope)
### Scope(v1)
- 단일 주문(장바구니 1개) + 가격쿠폰 1장 + 배송쿠폰 1장 조합 추천
- %/정액/배송 쿠폰 3종 지원
- Policy A/minSpend/반올림 규칙 고정

### Out of Scope(v1)
- 확률형 프로모션 EV, 포인트/캐시백 환산
- 제외 카테고리/결제수단 제한/시간 제한 등 복잡 조건
- 장바구니 분할, 세금/관부가세, 플랫폼별 정책 선택
